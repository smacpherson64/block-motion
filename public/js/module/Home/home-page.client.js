import q from"https://esm.sh/react@18.2.0/react.js";import J from"https://esm.sh/react-dom@18.2.0/client.js";import h from"https://esm.sh/react@18.2.0/react.js";import w from"https://esm.sh/react@18.2.0/react.js";import*as c from"https://esm.sh/react@18.2.0/react.js";var L=(r,e)=>u=>u<r?r:u>e?e:u,D=(r,e)=>u=>u<r?e:u>e?r:u;var d={NE:1,N:2,NW:4,E:8,W:16,SE:32,S:64,SW:128},R=(r,e,u)=>{let n=D(0,e-1),m=D(0,u-1);return r.map(t=>{if(t.type==="base")return t;if(t.type==="unit"){let{row:a,column:p}=t,f=n(a-1),g=n(a+1),o=m(p-1),i=m(p+1);switch(t.direction){case d.NE:return{...t,row:f,column:o};case d.N:return{...t,row:f,column:p};case d.NW:return{...t,row:f,column:i};case d.E:return{...t,row:a,column:o};case d.W:return{...t,row:a,column:i};case d.SE:return{...t,row:g,column:o};case d.S:return{...t,row:g,column:p};case d.SW:return{...t,row:g,column:i};default:return t}}return t})};var H=r=>r.type==="PLACE_BASE",O=r=>r.type==="PLACE_UNIT",V=({theme:r,row:e,column:u})=>{let n=r.blockSize,m=r.blockSize/2,t=u*n,a=e*n,p=t+m,f=a+m,g=p+n*-1,o=p+n,i=f+n*-1,y=f+n,s=L(g,o),b=L(i,y);return{x:t,y:a,cx:p,cy:f,minX:g,maxX:o,minY:i,maxY:y,halfBlock:m,clampX:s,clampY:b}};function Q(r){let{theme:e,index:u,emulatedDelta:n,action:m,column:t,row:a,player:p,onActivate:f=()=>{},blocks:g=[]}=r,o=c.useRef(),{y:i,cx:y,cy:s,clampX:b,clampY:$,halfBlock:S}=c.useMemo(()=>V({row:a,column:t,theme:e}),[a,t,e]),[X,C]=c.useState({x:0,y:0}),k=c.useMemo(()=>n||X,[X,n]),E=c.useMemo(()=>({x:b(y+k.x),y:$(s+k.y)}),[k.x,k.y,b,$,y,s]),N=c.useMemo(()=>{let l=E.x<y+S*-1,x=E.x>y+S,B=!l&&!x,T=E.y<s+S*-1,_=E.y>s+S,I=!T&&!_;switch(!0){case(l&&T):return d.NE;case(B&&T):return d.N;case(x&&T):return d.NW;case(l&&I):return d.E;case(x&&I):return d.W;case(l&&_):return d.SE;case(B&&_):return d.S;case(x&&_):return d.SW;case(B&&I):default:return null}},[E.x,E.y,S,y,s]),[j,M]=c.useState(!1),P=c.useMemo(()=>!!n||j,[!!n,j]),U=c.useMemo(()=>g.find(l=>l.type==="base")?"fill-red-500":P?"fill-slate-700":g.find(l=>l.type==="unit")?"fill-white":"fill-transparent",[g,P]);return m==="PLACE_BASE"?c.createElement("g",{className:"relative z-10"},c.createElement("rect",{onClick:()=>{f({type:m,payload:{type:"base",player:p,row:a,column:t}})},width:e.blockSize,height:e.blockSize,x:t*e.blockSize,y:i,radius:"10",className:U})):m==="PLACE_UNIT"?c.createElement("g",{className:"relative z-10"},c.createElement("rect",{onPointerDown:l=>{l.currentTarget.setPointerCapture(l.pointerId),M(!0)},onTouchMove:l=>{if(P){let x=l.touches[0],B=o.current;C({x:B?k.x+x.pageX-B.pageX:0,y:B?k.y+x.pageY-B.pageY:0}),o.current=x}},onTouchEnd:()=>{o.current=void 0},onPointerMove:l=>{P&&C({x:k.x+l.movementX,y:k.y+l.movementY})},onPointerUp:l=>{l.currentTarget.releasePointerCapture(l.pointerId),N&&f({type:"PLACE_UNIT",payload:{type:"unit",player:p,row:a,column:t,direction:N}}),M(!1),C({x:0,y:0})},onPointerCancel:l=>{l.currentTarget.releasePointerCapture(l.pointerId),N!==null&&f({type:"PLACE_UNIT",payload:{type:"unit",player:p,row:a,column:t,direction:N}}),M(!1),C({x:0,y:0})},width:e.blockSize,height:e.blockSize,x:t*e.blockSize,y:i,radius:"10",className:`select-none ${U} touch-manipulation`}),P?c.createElement(c.Fragment,null,c.createElement("path",{strokeLinecap:"round",className:"stroke-2 stroke-gray-400/30 z-10 relative",x:y,y:s,d:`M${y} ${s} L ${E.x} ${E.y} Z`}),c.createElement("circle",{cx:E.x,cy:E.y,r:e.blockSize*.18,className:"fill-gray-700"})):null):c.createElement("rect",{width:e.blockSize,height:e.blockSize,x:t*e.blockSize,y:i,radius:"10",className:U})}import*as v from"https://esm.sh/react@18.2.0/react.js";var A=(r,{columns:e})=>Math.floor(r/e),z=(r,{columns:e})=>r%e;function G(r){let{theme:e,children:u,players:n,rows:m,columns:t}=r,{height:a,width:p}=v.useMemo(()=>({height:e.blockSize*m,width:e.blockSize*t}),[e.blockSize,m,t]),f=v.useMemo(()=>new Array(m*t).fill(null).map((g,o)=>{let i=A(o,{columns:t}),y=z(o,{columns:t}),s=i*e.blockSize;return v.createElement("rect",{key:o,width:e.blockSize,height:e.blockSize,x:y*e.blockSize,y:s,radius:"10",strokeWidth:e.gap,className:"relative z-0 select-none stroke-slate-800 fill-transparent"})}),[]);return v.createElement("div",{className:"overflow-hidden bg-slate-900 border-2 border-gray-700 rounded-md relative select-none"},v.createElement("svg",{height:a,width:p,viewBox:`0 0 ${p} ${a}`,className:"relative"},n===2?v.createElement("rect",{x:p/2-2.5,y:"0",height:a,width:5,className:"fill-slate-800 z-0"}):null,f,u))}function Y(r){let{theme:e,rows:u,columns:n}=r,[m,t]=w.useState([]),[a,p]=w.useState(!1),f=!!m.find(o=>o.type==="base");w.useEffect(()=>{if(a){let o=setInterval(()=>{t(i=>R(i,u,n))},1e3);return()=>clearInterval(o)}},[a]);let g=w.useMemo(()=>new Array(u*n).fill(null).map((o,i)=>{let y=z(i,{columns:n}),s=A(i,{columns:n});return{column:y,row:s}}),[u,n]);return w.createElement(w.Fragment,null,w.createElement(G,{theme:e,rows:u,columns:n,players:1},g.map(({column:o,row:i},y)=>w.createElement(Q,{key:`${o}-${i}-${y}`,blocks:m.filter(({row:s,column:b})=>i===s&&o===b),theme:e,index:y,action:f?"PLACE_UNIT":"PLACE_BASE",player:1,row:i,column:o,onActivate:s=>{H(s)&&t(b=>[...b,s.payload]),O(s)&&(m.find(b=>b.type==="unit"&&b.direction===s.payload.direction&&b.row===s.payload.row&&b.column===s.payload.column)||t(b=>[...b,s.payload]))}}))),w.createElement("div",{className:"flex space-x-2 p-2"},w.createElement("button",{type:"button",onClick:()=>{t(o=>R(o,u,n))},className:"p-2 px-3 bg-slate-900 text-white rounded"},"Move Blocks"),w.createElement("button",{type:"button",onClick:()=>{p(o=>!o)},className:"p-2 px-3 bg-slate-900 text-white rounded"},a?"pause":"play")))}var K=5,F=9,Z={gap:1,blockSize:50};function W(){return h.createElement("html",{lang:"en-us",className:"h-full w-full"},h.createElement("head",null,h.createElement("meta",{charSet:"utf-8"}),h.createElement("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),h.createElement("meta",{name:"description",content:"Block motion is a live action strategy game where two players aim blocks at each other's bases."}),h.createElement("title",null,"Block motion \u2B05\uFE0F"),h.createElement("style",null,"body {overflow: hidden !important; -webkit-overflow-scrolling: touch;"),h.createElement("link",{rel:"stylesheet",href:"/public/styles.css"}),h.createElement("link",{rel:"icon",href:"data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>\u2B05\uFE0F</text></svg>"}),h.createElement("script",null),h.createElement("script",{type:"module",src:"/public/js/module/Home/home-page.client.js"}),h.createElement("script",{noModule:!0,src:"/public/js/classic/Home/home-page.client.js"})),h.createElement("body",{className:"bg-slate-800 h-full min-h-screen w-full grid place-items-center text-gray-100"},h.createElement("div",null,h.createElement(Y,{theme:Z,rows:K,columns:F}))))}J.hydrateRoot(document,q.createElement(W,null));
//# sourceMappingURL=home-page.client.js.map
